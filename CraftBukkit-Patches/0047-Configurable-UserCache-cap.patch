From 0dcbddde613f21fae79f3224c8d761a4fea8bc16 Mon Sep 17 00:00:00 2001
From: drXor <mcyoungsota@gmail.com>
Date: Fri, 25 Apr 2014 18:17:30 -0400
Subject: [PATCH] Configurable UserCache cap


diff --git a/src/main/java/net/minecraft/server/players/CachedUserNameToIdResolver.java b/src/main/java/net/minecraft/server/players/CachedUserNameToIdResolver.java
index 8537dbb7e3..df72f195e6 100644
--- a/src/main/java/net/minecraft/server/players/CachedUserNameToIdResolver.java
+++ b/src/main/java/net/minecraft/server/players/CachedUserNameToIdResolver.java
@@ -188,7 +188,7 @@ public class CachedUserNameToIdResolver implements UserNameToIdResolver {
         JsonArray jsonarray = new JsonArray();
         DateFormat dateformat = createDateFormat();
 
-        this.getTopMRUProfiles(1000).forEach((cachedusernametoidresolver_gameprofileinfo) -> {
+        this.getTopMRUProfiles(org.spigotmc.SpigotConfig.userCacheCap).forEach((cachedusernametoidresolver_gameprofileinfo) -> { // Spigot
             jsonarray.add(writeGameProfile(cachedusernametoidresolver_gameprofileinfo, dateformat));
         });
         String s = this.gson.toJson(jsonarray);
diff --git a/src/main/java/org/spigotmc/SpigotConfig.java b/src/main/java/org/spigotmc/SpigotConfig.java
index 87fbd498cb..c85de31677 100644
--- a/src/main/java/org/spigotmc/SpigotConfig.java
+++ b/src/main/java/org/spigotmc/SpigotConfig.java
@@ -314,4 +314,10 @@ public class SpigotConfig
         replaceCommands = new HashSet<String>( (List<String>) getList( "commands.replace-commands",
                 Arrays.asList( "setblock", "summon", "testforblock", "tellraw" ) ) );
     }
+
+    public static int userCacheCap;
+    private static void userCacheCap()
+    {
+        userCacheCap = getInt( "settings.user-cache-size", 1000 );
+    }
 }
-- 
2.52.0

